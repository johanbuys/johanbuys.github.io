<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Tutorials | AppBase]]></title>
  <link href="http://blog.appbase.co/blog/categories/tutorials/atom.xml" rel="self"/>
  <link href="http://blog.appbase.co/"/>
  <updated>2014-04-01T15:34:48+02:00</updated>
  <id>http://blog.appbase.co/</id>
  <author>
    <name><![CDATA[Johan Buys]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Setup Publishing via Git Windows Server 2008 IIS]]></title>
    <link href="http://blog.appbase.co/blog/2014/04/01/setting-up-webpublishing-via-git-windows-server-2008/"/>
    <updated>2014-04-01T14:23:18+02:00</updated>
    <id>http://blog.appbase.co/blog/2014/04/01/setting-up-webpublishing-via-git-windows-server-2008</id>
    <content type="html"><![CDATA[<p>Recently I had to setup a web publishing environment to publish web pages on a live site. Ftp was out of the question seeing as the ports to ftp where blocked on the vps we where using, so I had to use ssh.</p>

<p>Now in retrospect I could have simply used scp or something similar but as always I chose the long and hard road.</p>

<p><strong>Setup the server</strong></p>

<ul>
<li>Set up a new website on the server using the IIS manager.</li>
<li>Choose a local folder to be the document root</li>
<li>Downloaded and Install <a href="http://www.bitvise.com/winsshd" title="Bitvise SSH Server">Bitvise SSH server</a></li>
<li>Downloaded and extract <a href="https://code.google.com/p/msysgit/downloads/detail?name=PortableGit-1.9.0-preview20140217.7z&amp;can=2&amp;q=">Msysgit Protable Git</a> into C:\Git</li>
<li>Add C:\Git\bin and C:\Git\cmd to PATH variable</li>
<li><p>Next Configure the SSH Server</p>

<ul>
<li>I used steps from <a href="http://blog.chronosinteractive.com/posts/using-windows-server-host-git-repository">http://blog.chronosinteractive.com/posts/using-windows-server-host-git-repository</a></li>
<li>Follow the easy setup steps.</li>
<li>Generate an RSA host key

<ul>
<li>Under &ldquo;Host Keys&rdquo; click &ldquo;Manage host keys&rdquo;</li>
<li>Click &ldquo;Generate newâ€¦&rdquo;</li>
<li>Make sure the algorithm is set to &ldquo;rsa&rdquo;</li>
<li>Make sure the size is set to 1024</li>
<li>Check the box to &ldquo;Set as employed keypair for this algorithm&rdquo;</li>
<li>Click &ldquo;Generate&rdquo;</li>
</ul>
</li>
<li>Close out of windows until you arrive again at the main control panel screen</li>
<li>Configure the &ldquo;Everyone&rdquo; group to work with Git.

<ul>
<li>Under &ldquo;Settings&rdquo;, click on &ldquo;Edit advanced settings&rdquo;</li>
<li>Select &ldquo;Windows groups&rdquo; from the tray on the left</li>
<li>Select the &ldquo;Everyone&rdquo; group and click &ldquo;Edit&rdquo;</li>
<li>Set &ldquo;Exec request prefix&rdquo; to cmd.exe /c sh gitcmdhelper.sh (last character must be a space)</li>
<li>Click &ldquo;OK&rdquo;</li>
</ul>
</li>
<li>Create gitcmdhelper.sh

<ul>
<li>Create a new file in C:\Git\bin titled gitcmdhelper.sh Set file contents to: $*</li>
</ul>
</li>
<li>Test the connection.</li>
</ul>
</li>
<li><p>Next Login via ssh from your local machine</p>

<p>   ssh <a href="&#x6d;&#97;&#105;&#x6c;&#116;&#111;&#58;&#117;&#115;&#101;&#114;&#64;&#115;&#101;&#114;&#118;&#x65;&#114;&#x2e;&#99;&#111;&#x6d;">&#117;&#x73;&#101;&#x72;&#x40;&#115;&#x65;&#x72;&#118;&#x65;&#x72;&#46;&#99;&#111;&#x6d;</a></p></li>
<li><p>Create a Directory where you will have your git repository.</p></li>
</ul>


<blockquote><pre><code>mkdir mywebsite.git 
cd mywebsite.git
</code></pre></blockquote>

<ul>
<li>do a</li>
</ul>


<blockquote><pre><code>git init --bare
</code></pre></blockquote>

<ul>
<li>This will create a &ldquo;Bare&rdquo; Git repo, only the .git content will reside here, don&rsquo;t worry this is how we want it.</li>
<li>Next we will create a hook ( a hook is a set of commands that will run based on some repo actions)</li>
<li>Make sure you are in the repo dir and that there are some folders in there one we will use is aptly named &ldquo;hooks&rdquo;.</li>
<li>do a</li>
</ul>


<blockquote><pre><code>cat &gt; hooks/post-receive
</code></pre></blockquote>

<ul>
<li>and enter the following</li>
</ul>


<blockquote><pre><code>#!/bin/sh
git --work-tree=/path/to/site/web/root checkout -f
</code></pre></blockquote>

<p>Ctrl+c will end input.</p>

<p>Make sure to replace the &ldquo;/path/to/site/web/root&rdquo; with the folder we created in the beginning (where IIS will look for the website)</p>

<p>make the file executable doing a</p>

<pre><code>chmod +x post-receive
</code></pre>

<p><strong>Setup Your Client</strong></p>

<p>On your local machine issue the following</p>

<pre><code>git remote add production git@myserver.com/path/to/mywebsite.git
git push production +master:refs/heads/master
</code></pre>

<p>And when you have changes to push to production simply
do a normal</p>

<pre><code>git push production
</code></pre>
]]></content>
  </entry>
  
</feed>
